<html>
  <head>
    <title>PET ä¾¿åˆ©è´´OFFICE ä»£ç ä»“åº“</title>
    
  </head>
  <body>
    <p>
      import tkinter as tk<br>
      from tkinter import ttk<br>
      from tkinter.scrolledtext import ScrolledText<br>
      from selenium import webdriver  # æ§åˆ¶æµè§ˆå™¨çš„æ ¸å¿ƒæ¨¡å—<br>
      from selenium.webdriver.chrome.service import Service  # ç®¡ç†ChromDriveræœåŠ¡<br>
      from webdriver_manager.chrome import ChromeDriverManager  # è‡ªåŠ¨ä¸‹è½½å¹¶ç®¡ç†ChromeDriver<br>
      import webbrowser<br>
      from selenium.webdriver.common.by import By  # å®šä¹‰å…ƒç´ å®šä½æ–¹å¼<br>
      from selenium.webdriver.support.ui import WebDriverWait  # æ˜¾ç¤ºç­‰å¾…å·¥å…·<br>
      from selenium.webdriver.support import expected_conditions as EC  # å¸¸ç”¨ç­‰å¾…æ¡ä»¶<br>
      import time<br>
      import threading<br>
      from selenium.webdriver.common.keys import Keys<br>
      from PIL import Image, ImageDraw, ImageFont, ImageFilter, ImageEnhance, ImageTk<br>
      import requests<br>
      from io import BytesIO<br>
      
      main_ç‰ˆæœ¬ = '3.3.0'<br>
      green_f = tk.Tk()<br>
      green_f.title(f'ç»¿æ¢µAI [{main_ç‰ˆæœ¬}]')<br>
      green_f.geometry('355x250')<br>
      green_f.resizable(False, False)  # ç¦æ­¢<br>
      
      Label1 = tk.Label(green_f, text='åˆå§‹åŒ–è¿›ç¨‹', font=('å¾®è½¯é›…é»‘ Light', 17))<br>
      Label1.place(x=20, y=25)<br>
      Label2 = tk.Label(green_f, text='è¾“å…¥æ¥è‡ªGoogle Chrameæµè§ˆå™¨åœ°å€', font=('å¾®è½¯é›…é»‘ Light', 14))<br>
      Label2.place(x=20, y=72)<br>
      entry1 = ttk.Entry(green_f, font=('å¾®è½¯é›…é»‘', 13))<br>
      entry1.place(x=20, y=155, height=34, width=205)<br>
      style = ttk.Style()<br>
      style.configure('TButton', font=('å¾®è½¯é›…é»‘', 13))<br>
      
      place = ''<br>
      ç‰ˆæœ¬ = ''<br>
      é¡ºåº = 0<br>
      word = ''<br>
      word_code = ''<br>
      chat_æ§åˆ¶ = 0<br>
      chat_æ§åˆ¶_control = 0<br>
      
      
      def main():<br>
         try:<br>
              global place, ç‰ˆæœ¬, driver<br>
              green_AIf = tk.Tk()<br>
      
              æ¨¡å¼_deepseek_ç‰ˆæœ¬ = 'DeepSeek-R1'<br>
              æ¨¡å¼_deepseek_æ·±åº¦æ€è€ƒ = 1<br>
              æ¨¡å¼_deepseek_è”ç½‘æœç´¢ = 1<br>
              æ¨¡å¼_deepseekthink_see=1<br>
              btnT_x = 275<br>
              btnT_y = 175<br>
              btnT_height = 48<br>
              btnT_width = 48<br>
              btnT_image_height = 38<br>
              btnT_image_width = 37<br>
      
              def mu():<br>
                  global chat_æ§åˆ¶_control<br>
                  try:<br>
                      if chat_æ§åˆ¶_control == 0:<br>
                          NORMAL()<br>
                      else:<br>
                          DISABLED()<br>
                  except:<br>
                      mu()<br>
              def mu1():<br>
                  nonlocal btnT_x, btnT_y, btnT_height, btnT_width, btnT_image_height, btnT_image_width<br>
                  green_AIf.geometry('344x250')<br>
                  txt_edit.config(height=7, width=33)<br>
                  entry3.place(x=22, y=175, width=250, height=46)<br>
                  btnT.place(x=275, y=175, height=48, width=48)<br>
                  btnT_x = 275<br>
                  btnT_y = 175<br>
                  btnT_height = 48<br>
                  btnT_width = 48<br>
                  btnT_image_height = 38<br>
                  btnT_image_width = 37<br>
                  mu()<br>
              def mu2():<br>
                  nonlocal btnT_x, btnT_y, btnT_height, btnT_width, btnT_image_height, btnT_image_width<br>
                  green_AIf.geometry('544x450')<br>
                  txt_edit.config(height=18, width=55)<br>
                  entry3.place(x=22, y=390, width=445, height=52)<br>
                  btnT.place(x=472, y=390, height=53, width=51)<br>
                  btnT_x = 472<br>
                  btnT_y = 390<br>
                  btnT_height = 53<br>
                  btnT_width = 51<br>
                  btnT_image_height = 42<br>
                  btnT_image_width = 43<br>
                  mu()<br>
              def mu3():<br>
                  nonlocal btnT_x, btnT_y, btnT_height, btnT_width, btnT_image_height, btnT_image_width<br>
                  green_AIf.geometry('744x650')<br>
                  txt_edit.config(height=27, width=77)<br>
                  entry3.place(x=22, y=573, width=635, height=56)<br>
                  btnT.place(x=663, y=573, height=57, width=57)<br>
                  btnT_x = 663<br>
                  btnT_y = 573<br>
                  btnT_height = 57<br>
                  btnT_width = 57<br>
                  btnT_image_height = 47<br>
                  btnT_image_width = 47<br>
                  mu()<br>
      
              green_AIf.title(f'ç»¿æ¢µAI [{main_ç‰ˆæœ¬}]')<br>
              green_AIf.geometry('344x250')<br>
              green_AIf.resizable(False, False)  # ç¦æ­¢<br>
              entry3 = ttk.Entry(green_AIf, font=('å¾®è½¯é›…é»‘', 13))<br>
              entry3.place(x=22, y=175, height=46, width=250)<br>
              txt_edit = tk.Text(green_AIf, wrap=tk.WORD, width=33, font=('å¾®è½¯é›…é»‘', 11), height=7, undo=True)<br>
              txt_edit.place(x=22, y=13)<br>
              txt_edit.config(state=tk.NORMAL)<br>
              txt_edit.delete('1.0', tk.END)<br>
              txt_edit.config(state='disabled')<br>
              txt_edit.tag_config('error', foreground='#FF6A6A')<br>
      
              # åˆ›å»ºScrollbarç»„ä»¶<br>
              scrollbar = tk.Scrollbar(green_AIf, orient=tk.VERTICAL, command=txt_edit.yview)<br>
              scrollbar.pack(side=tk.RIGHT, fill=tk.Y)<br>
      
              # é…ç½®Textç»„ä»¶ä¸Scrollbarçš„å…³ç³»<br>
              txt_edit['yscrollcommand'] = scrollbar.set<br>
      
              chat_net_é¡ºåº = 1<br>
              chat_ç‰ˆæœ¬ = 'DeepSeek-R1'<br>
              chat_index = 0<br>
      
              def change_ç‰ˆæœ¬(ç‰ˆæœ¬):<br>
                  nonlocal chat_index<br>
                  if ç‰ˆæœ¬ == 'DeepSeek-R1':<br>
                      chat_index = 0<br>
                      return 'ç»¿æ¢µ-R1'<br>
                  elif ç‰ˆæœ¬ == 'DeepSeek-V3.2':<br>
                      chat_index = 1<br>
                      return 'ç»¿æ¢µ-V3.2'<br>
                  else:<br>
                      chat_index = 2<br>
                      return 'ç½‘é¡µæ£€ç´¢-C1'<br>
              def change_chat_ç‰ˆæœ¬(chat_ç‰ˆæœ¬):<br>
                  return change_ç‰ˆæœ¬(chat_ç‰ˆæœ¬)<br>
      
              def chat_son(value):<br>
                  nonlocal æ¨¡å¼_deepseek_ç‰ˆæœ¬, chat_ç‰ˆæœ¬, chat_net_é¡ºåº, chat_thought_é¡ºåº, btnT_close,æ¨¡å¼_deepseek_æ·±åº¦æ€è€ƒ,æ¨¡å¼_deepseek_è”ç½‘æœç´¢<br>
                  global ç‰ˆæœ¬<br>
                  global chat_æ§åˆ¶<br>
                  try:<br>
                      btnT_close = 1<br>
                      menu_bar.entryconfig('ç‰ˆæœ¬', state='disabled')<br>
                      btnT.config(state='disabled')<br>
                      if value == 'ç½‘é¡µæ£€ç´¢-C1':<br>
                          btnT_close = 1<br>
                          # è®¿é—®ç½‘å€<br>
                          url = 'https://www.baidu.com'<br>
                          driver.get(url)<br>
                          chat_æ§åˆ¶ = 2<br>
                          ç‰ˆæœ¬ = chat_ç‰ˆæœ¬<br>
      
                          file_menu2.entryconfig(4, label="è”ç½‘æ¨¡å¼", state='disabled')<br>
                          file_menu2.entryconfig(6, label="æ·±åº¦æ€è€ƒ", state='disabled')<br>
                          chat_ç‰ˆæœ¬ = value<br>
                          æ¨¡å¼_deepseek_ç‰ˆæœ¬ = value<br>
      
                          # åˆ·æ–°åˆ—è¡¨<br>
                          change_ç‰ˆæœ¬(ç‰ˆæœ¬)<br>
                          file_menu2.entryconfig(f"{chat_index}", label=f"{change_ç‰ˆæœ¬(ç‰ˆæœ¬)}")<br>
                          change_chat_ç‰ˆæœ¬(chat_ç‰ˆæœ¬)<br>
                          file_menu2.entryconfig(f"{chat_index}", label=f"{change_chat_ç‰ˆæœ¬(chat_ç‰ˆæœ¬)} âˆš")<br>
                          btnT.close = 0<br>
                          btnT.config(state='normal')<br>
                          menu_bar.entryconfig('ç‰ˆæœ¬', state='normal')<br>
                          file_menu.entryconfig(1, state='disabled')<br>
                          return<br>
                      ç‰ˆæœ¬ = chat_ç‰ˆæœ¬<br>
                      if chat_æ§åˆ¶!=1:chat_æ§åˆ¶ = 0<br>
                      if ç‰ˆæœ¬ == 'ç½‘é¡µæ£€ç´¢-C1':<br>
                          if chat_æ§åˆ¶==0:<br>
                              chat_net_é¡ºåº=1<br>
                              chat_thought_é¡ºåº=1<br>
                              æ¨¡å¼_deepseek_è”ç½‘æœç´¢=1<br>
                              æ¨¡å¼_deepseek_æ·±åº¦æ€è€ƒ=1<br>
                          file_menu.entryconfig(1, state='normal')<br>
                          url = f'https://chat.baidu.com/search?&dyTabStr=MCwxMiwzLDEsMiwxMyw3LDYsNSw5&pd=csaitab&setype=csaitab&extParamsJson=%7B%22enter_type%22%3A%22search_a_tab%22%2C%22sa%22%3A%22vs_tab%22%2C%22apagelid%22%3A%229405376116451188355%22%2C%22ori_lid%22%3A%229405376116451188355%22%7D'<br>
                          driver.get(url)  # æ‰“å¼€ç½‘é¡µ<br>
      
                      file_menu2.entryconfig(4, state='normal')<br>
                      file_menu2.entryconfig(6, state='normal')<br>
                      button = driver.find_element(By.CSS_SELECTOR, "[class*='model-select-toggle']")<br>
                      button.click()<br>
                      wait = WebDriverWait(driver, 60)<br>
      
                      # å®šä½æ‰€æœ‰classä¸º"input-capsules-model-list-item"çš„å…ƒç´ <br>
                      all_items = wait.until(<br>
                          EC.presence_of_all_elements_located(<br>
                              (By.CLASS_NAME, "ci-capsules-model-list-item-text")<br>
                          )<br>
                      )<br>
                      # éå†å…ƒç´ å¯»æ‰¾ç›®æ ‡æŒ‰é’®<br>
                      for item in all_items:<br>
                          green_AIf.after(500)<br>
                          # æ£€æŸ¥å…ƒç´ å†…æ˜¯å¦åŒ…å«"DeepSeek-V3æœ€æ–°ç‰ˆ"æ ‡é¢˜<br>
                          title_element = item.find_element(<br>
                              By.CLASS_NAME, "ci-capsules-model-list-item-title"<br>
                          )<br>
      
                          ç‰ˆæœ¬ = chat_ç‰ˆæœ¬<br>
                          if title_element.text == value:<br>
                              # ç‚¹å‡»ç›®æ ‡æŒ‰é’®<br>
                              item.click()<br>
                              chat_ç‰ˆæœ¬ = value<br>
                              æ¨¡å¼_deepseek_ç‰ˆæœ¬ = value<br>
                              button = driver.find_element(By.CSS_SELECTOR, "[class*='model-select-toggle")<br>
                              button.click()<br>
                              break<br>
                      # åˆ·æ–°åˆ—è¡¨<br>
                      change_ç‰ˆæœ¬(ç‰ˆæœ¬)<br>
                      file_menu2.entryconfig(f"{chat_index}", label=f"{change_ç‰ˆæœ¬(ç‰ˆæœ¬)}")<br>
                      change_chat_ç‰ˆæœ¬(chat_ç‰ˆæœ¬)<br>
                      file_menu2.entryconfig(f"{chat_index}", label=f"{change_chat_ç‰ˆæœ¬(chat_ç‰ˆæœ¬)} âˆš")<br>
                      btnT.config(state='normal')<br>
                      menu_bar.entryconfig('ç‰ˆæœ¬', state='normal')<br>
                  except Exception as e:<br>
                      txt_edit.insert(tk.END, f'å‘ç”Ÿé”™è¯¯:\n{e}', 'error')<br>
                  finally:<br>
                      btnT_close = 0<br>
      
              def chat(value):<br>
                  threading.Thread(target=chat_son(value), daemon=True).start()<br>
      
              def net():<br>
                  nonlocal chat_net_é¡ºåº, æ¨¡å¼_deepseek_è”ç½‘æœç´¢, btnT_close,æ¨¡å¼_deepseek_æ·±åº¦æ€è€ƒ,chat_thought_é¡ºåº<br>
                  try:<br>
                      btnT_close = 1<br>
                      btnT.config(state='disabled')<br>
                      menu_bar.entryconfig('ç‰ˆæœ¬', state='disabled')<br>
                      button = driver.find_element(By.CSS_SELECTOR, "[class*='model-select-toggle']")<br>
                      button.click()<br>
                      green_AIf.after(300)<br>
                      button = driver.find_element(By.CSS_SELECTOR, "[class*='ci-switcher ci-sm']")<br>
                      button.click()<br>
                      chat_net_é¡ºåº += 1<br>
      
                      if (chat_net_é¡ºåº % 2 != 0):<br>
                          æ¨¡å¼_deepseek_è”ç½‘æœç´¢ = 1<br>
                          file_menu2.entryconfig(4, label="è”ç½‘æ¨¡å¼")<br>
                      else:<br>
                          æ¨¡å¼_deepseek_è”ç½‘æœç´¢ = 0<br>
                          file_menu2.entryconfig(4, label="è”ç½‘æ¨¡å¼ âˆš")<br>
                      button = driver.find_element(By.CSS_SELECTOR, "[class*='model-select-toggle']")<br>
                      button.click()<br>
      
                      btnT.config(state='normal')<br>
                      menu_bar.entryconfig('ç‰ˆæœ¬', state='normal')<br>
                  except Exception as e:<br>
                      txt_edit.insert(tk.END, f'å‘ç”Ÿé”™è¯¯:\n{e}', 'error')<br>
                      pass<br>
                  finally:<br>
                      btnT_close = 0<br>
                      btnT.config(state='normal')<br>
                      menu_bar.entryconfig('ç‰ˆæœ¬', state='normal')<br>
      
              def thought():<br>
                  nonlocal chat_thought_é¡ºåº, æ¨¡å¼_deepseek_æ·±åº¦æ€è€ƒ, btnT_close<br>
                  try:<br>
                      btnT_close = 1<br>
                      btnT.config(state='disabled')<br>
                      menu_bar.entryconfig('ç‰ˆæœ¬', state='disabled')<br>
                      button = driver.find_element(By.CSS_SELECTOR, "[class*='internet-search-icon']")<br>
                      button.click()<br>
                      green_AIf.after(300)<br>
                      chat_thought_é¡ºåº += 1<br>
                      if (chat_thought_é¡ºåº % 2 != 0):<br>
                          æ¨¡å¼_deepseek_æ·±åº¦æ€è€ƒ = 1<br>
                          file_menu2.entryconfig(6, label="æ·±åº¦æ€è€ƒ")<br>
                      else:<br>
                          æ¨¡å¼_deepseek_æ·±åº¦æ€è€ƒ = 0<br>
                          file_menu2.entryconfig(6, label="æ·±åº¦æ€è€ƒ âˆš")<br>
                      btnT.config(state='normal')<br>
                      menu_bar.entryconfig('ç‰ˆæœ¬', state='normal')<br>
      
                  except Exception as e:<br>
                      txt_edit.insert(tk.END, f'å‘ç”Ÿé”™è¯¯:{e}', 'error')<br>
                  finally:<br>
                      btnT_close = 0<br>
      
              def exchange():<br>
                  global word, chat_æ§åˆ¶<br>
                  nonlocal collect_continue, collect_exchange, chat_net_é¡ºåº, chat_thought_é¡ºåº<br>
                  global ç‰ˆæœ¬<br>
                  try:<br>
                      txt_edit.config(state='normal')<br>
                      # ä¿å­˜å½“å‰è¾“å…¥çš„å†…å®¹<br>
                      current_input = word_code if word_code else entry3.get()<br>
                      # æ¸…ç©ºè¾“å…¥æ¡†<br>
                      entry3.delete(0, tk.END)<br>
                      # è®¾ç½®é‡æ–°å›ç­”æ ‡å¿—<br>
                      word = current_input<br>
                      if collect_continue == 1:<br>
                          chat_æ§åˆ¶ = 2<br>
                          chat('ç½‘é¡µæ£€ç´¢-C1')<br>
                          collect_continue = 0<br>
                          collect_exchange = 1<br>
                      else:<br>
                          chat_æ§åˆ¶ = 1<br>
                          collect_exchange = 2<br>
                      ok()<br>
                  except Exception as e:<br>
                      txt_edit.insert(tk.END, f'æ— æ³•é‡æ–°å›å¤ï¼Œè¯·ç¨åé‡è¯• \n{e}\n', 'error')<br>
                      green_AIf.update()<br>
                  finally:<br>
                      # ç¡®ä¿æŒ‰é’®çŠ¶æ€æ¢å¤æ­£å¸¸<br>
                      NORMAL()<br>
                      txt_edit.config(state='disabled')<br>
      
              chat_thought_é¡ºåº = 1<br>
      
              def AI_text():<br>
                  entry3.delete(0, tk.END)<br>
                  entry3.insert(tk.END, 'å†™ä¸€ç¯‡_____ï¼Œå†…å®¹å…³äº _____ ï¼Œå­—æ•° xxxå­—')<br>
              def AI_program():<br>
                  entry3.delete(0, tk.END)<br>
                  entry3.insert(tk.END, 'ç»™æˆ‘ç¼–ä¸€ä¸ªå…³äº____çš„ç¨‹åºï¼Œç”¨xxxè¯­è¨€')<br>
              def AI_picture():<br>
                  entry3.delete(0, tk.END)<br>
                  entry3.insert(tk.END, 'ç»™æˆ‘ç”Ÿæˆä¸€ä¸ªå…³äº____çš„å›¾ç‰‡')<br>
              def AI_ftalk():<br>
                  entry3.delete(0, tk.END)<br>
                  entry3.insert(tk.END, 'ç¿»è¯‘xxxçš„ä¸­æ–‡æ„æ€')<br>
      
              collect_continue = 0<br>
              collect_link = 0<br>
              collect_exchange = 0<br>
      
              def open_link(link):<br>
                  try:<br>
                      webbrowser.open(link)<br>
                  except:<br>
                      return<br>
      
              def collect():<br>
                  nonlocal entry3, ok_æ¬¡, collect_continue, collect_link, collect_exchange<br>
                  global driver, word, word_code, chat_æ§åˆ¶, chat_æ§åˆ¶_control<br>
                  nonlocal æ¨¡å¼_deepseek_æ·±åº¦æ€è€ƒ, æ¨¡å¼_deepseek_è”ç½‘æœç´¢, æ¨¡å¼_deepseek_ç‰ˆæœ¬<br>
                  try:<br>
                      menu_bar.entryconfig('ç‰ˆæœ¬', state='disabled')<br>
                      file_menu2.entryconfig(4, label="è”ç½‘æ¨¡å¼", state='disabled')<br>
                      file_menu2.entryconfig(6, label="æ·±åº¦æ€è€ƒ", state='disabled')<br>
                      chat_æ§åˆ¶_control = 1<br>
                      DISABLED()<br>
                      if collect_exchange == 0:<br>
                          word = entry3.get()<br>
      
                      url = 'https://www.baidu.com'<br>
                      driver.get(url)<br>
      
                      word_code = word<br>
                      entry3.delete(0, tk.END)<br>
                      input_element_find = driver.find_element(By.ID, "chat-textarea")<br>
                      # è¾“å…¥é—®é¢˜<br>
                      word_find_text = word<br>
                      input_element_find.send_keys(word)<br>
                      # æ¨¡æ‹Ÿå›è½¦é”®æäº¤<br>
                      input_element_find.send_keys(Keys.RETURN)<br>
                      try:<br>
                          txt_edit.config(state='normal')<br>
                          # è®¾ç½®é¢œè‰²æ ‡ç­¾<br>
                          txt_edit.tag_config('blue', foreground='#3487FF')<br>
                          txt_edit.insert(tk.END, f'{æ¨¡å¼_deepseek_ç‰ˆæœ¬}\næˆ‘è¦æ£€ç´¢çš„å†…å®¹:\n{word}\n', 'blue')<br>
                          green_AIf.after(300)<br>
                          txt_edit.insert(tk.END, 'æ£€ç´¢ä¸­~\n')<br>
                          # ç­‰å¾…ç¬¬ä¸€ä¸ªæ£€ç´¢æ®µè½å‡ºç°<br>
                          try:<br>
                              WebDriverWait(driver, 25, 0.3).until(<br>
                                  # ä½¿ç”¨ç¨³å®šçš„é€‰æ‹©å™¨<br>
                                  # class=è¿™ç§æœ€ç²¾ç¡®ï¼Œä¸æ˜¯åªè¦åŒ…å«è¿™ä¸ªå…ƒç´ åå°±è¡Œ<br>
                                  EC.presence_of_element_located((By.ID, "content_left"))<br>
                              )<br>
                          except:<br>
                              txt_edit.insert(tk.END, f'çª—å£è«åå‡ºç°äº†é—®é¢˜ï¼Œè¯·é‡æ–°è¿›å…¥~\n', 'error')<br>
                      except Exception as e:<br>
                          txt_edit.insert(tk.END, f'å‘ç”Ÿé”™è¯¯:{e}')<br>
                      # æ£€æŸ¥æ˜¯å¦å…¨éƒ¨ç”Ÿæˆå‡ºæ¥<br>
                      try:<br>
                          txt_edit.insert(tk.END, 'æ£€æŸ¥ä¸­~\n')<br>
                          WebDriverWait(driver, 180, 0.3).until(<br>
                              # untilåªèƒ½æœ‰ä¸€ä¸ªç­‰å¾…å€¼ä½†æ˜¯any_of/all_ofå¯ä»¥æœ‰å¤šä¸ª<br>
                              EC.all_of(<br>
                                  # ä½¿ç”¨ç¨³å®šçš„é€‰æ‹©å™¨<br>
                                  # class=è¿™ç§æœ€ç²¾ç¡®ï¼Œä¸æ˜¯åªè¦åŒ…å«è¿™ä¸ªå…ƒç´ åå°±è¡Œ<br>
                                  # class*=è¿™ç§åªè¦éƒ¨åˆ†è¾¾æ ‡å³å¯å¯ä»¥é˜²æ­¢å› ç½‘é¡µä»£ç æ›´æ–°é€ æˆçš„é”™è¯¯<br>
                                  EC.presence_of_element_located((By.ID, "content_left")),<br>
                              )<br>
                          )<br>
                      except Exception as e:<br>
                          txt_edit.insert(tk.END, f'ç³»ç»Ÿè¶…æ—¶~\n{e}\n', 'error')<br>
                          green_AIf.update()<br>
                      # æ»šåŠ¨åˆ°åº•éƒ¨ï¼Œè§¦å‘æ‰€æœ‰å†…å®¹æ¸²æŸ“<br>
                      driver.execute_script("window.scrollTo(0, document.body.scrollHeight);")<br>
                      time.sleep(1.5)<br>
                      # æŸ¥æ‰¾æ‰€æœ‰classä¸ºxxxçš„é¡¹ç›®<br>
                      paragraphs_find = driver.find_elements(By.CSS_SELECTOR, '.result.new-pmd')<br>
      
                      for i, p in enumerate(paragraphs_find, 0):<br>
                          try:<br>
                              # å®æ—¶æ‰¾æœ€æ–°çš„å…ƒç´ <br>
                              p = driver.find_elements(By.CSS_SELECTOR, '.result.new-pmd') [<br>
                                  i]  # æå–åªéœ€åŒ…å«è¿™ä¸‰ä¸ªç‰¹å®šçš„classå°±è¡Œäº†,ä¸å¿…å®Œå…¨ç›¸åŒ(.åè¡¥ç©ºæ ¼)<br>
                              text = p.text.strip()<br>
                              url_p = p.get_attribute("href")<br>
                              try:<br>
                                  link_element = p.find_element(By.CSS_SELECTOR, "h3 a")  # ç™¾åº¦æ ‡é¢˜é€šå¸¸åœ¨ h3 > a ä¸­(' 'ç©ºæ ¼è¡¨ç¤ºåŒ…å«)<br>
                                  url_p = link_element.get_attribute("href")<br>
                                  url_p_text = p.text.strip()<br>
                                  if url_p and url_p_text:<br>
                                      collect_link += 1<br>
                                      txt_edit.tag_config(f'{collect_link}', foreground='#3282F6', underline=True)<br>
                                      txt_edit.insert(tk.END, f'{url_p_text}: \n{url_p}', f'{collect_link}')<br>
                                      txt_edit.tag_bind(f"{collect_link}", "<Button-1>", lambda e: open_link(f"{url_p}"))<br>
                              except:<br>
                                  txt_edit.insert(tk.END, "\n")<br>
      
                              # 3. æå–å›¾ç‰‡ï¼ˆå¦‚æœæœ‰ç¼©ç•¥å›¾ï¼‰<br>
                              try:<br>
                                  # element å…ƒç´ <br>
                                  img_element = p.find_element(By.CSS_SELECTOR, "img")  # æŸ¥æ‰¾å®¹å™¨å†…çš„ img<br>
                                  # attributeå±æ€§<br>
                                  img_src = img_element.get_attribute("src")<br>
                                  if img_src and not img_src.startswith("data:"):  # è¿‡æ»¤ base64 å ä½å›¾<br>
                                      response = requests.get(img_src, timeout=10)<br>
                                      #  response.raise_for_status()  # æŠ›å‡º HTTP é”™è¯¯ï¼ˆå¦‚ 404ã€500ï¼‰<br>
                                      img_data = BytesIO(response.content)  # å°†å†…å®¹è½½å…¥å†…å­˜æµ<br>
                                      img = Image.open(img_data)<br>
                                      # è°ƒæ•´å›¾ç‰‡å¤§å°ï¼ˆå¯é€‰ï¼Œé¿å…è¿‡å¤§ï¼‰<br>
                                      img.thumbnail((150, 250))  # æœ€å¤§å®½é«˜ 400px<br>
                                      img_tk = ImageTk.PhotoImage(img)<br>
                                      # åœ¨ Tkinter æ–‡æœ¬æ¡†ä¸­æ˜¾ç¤ºå›¾ç‰‡<br>
                                      collect_link += 1<br>
                                      txt_edit.tag_config(f'{collect_link}', foreground='#2DC9B4', underline=True)<br>
                                      txt_edit.insert(tk.END, f"\nå›¾ç‰‡:\n{img_src}\n\n", f'{collect_link}')<br>
                                      txt_edit.tag_bind(f"{collect_link}", "<Button-1>", lambda e: open_link(f"{img_src}"))<br>
      
                                      txt_edit.image_create(tk.END, image=img_tk)<br>
                                      txt_edit.insert(tk.END, "\n\n")<br>
                                      # ä¿®æ­£ï¼šä½¿ç”¨åˆ—è¡¨ä¿å­˜æ‰€æœ‰å›¾ç‰‡å¼•ç”¨ï¼Œè€Œä¸æ˜¯è¦†ç›–å•ä¸ªå˜é‡<br>
                                      if not hasattr(txt_edit, 'image_list'):<br>
                                          txt_edit.image_list = []<br>
                                      txt_edit.image_list.append(img_tk)  # ä¿å­˜å¼•ç”¨åˆ°åˆ—è¡¨ï¼Œé˜²æ­¢åƒåœ¾å›æ”¶<br>
      
                              except:<br>
                                  txt_edit.insert(tk.END, "\n")<br>
                              finally:<br>
                                  txt_edit.insert(tk.END, '\n\n')<br>
                          except Exception as e:<br>
                              txt_edit.insert(tk.END, f'å‘ç”Ÿé”™è¯¯:{e}', 'error')<br>
                  except Exception as e:<br>
                      txt_edit.insert(tk.END, f'å‘ç”Ÿé”™è¯¯:{e}\n''error')<br>
                      green_AIf.update()<br>
                  finally:<br>
                      # é‡Šæ”¾å†…å­˜å’Œç³»ç»Ÿèµ„æº<br>
                      collect_exchange = 0<br>
                      collect_continue = 1<br>
                      txt_edit.insert(tk.END, f'æ£€ç´¢å®Œæˆ~\n-------------------------\n\n','blue')<br>
                      green_AIf.bind('<Return>', lambda event: ok())<br>
      
                      chat_æ§åˆ¶_control = 0<br>
                      menu_bar.entryconfig('ç‰ˆæœ¬', state='normal')<br>
                      NORMAL()<br>
                      file_menu.entryconfig('é‡æ–°å›å¤ ğŸ—˜', state='normal')<br>
                      txt_edit.config(state='disabled')<br>
                      green_AIf.update()<br>
      
              def introduce():<br>
                  wordd = tk.Tk()<br>
                  wordd.title("ç»¿æ¢µAI ä»‹ç»")<br>
                  wordd.geometry("340x340")<br>
                  wordd.resizable(False, False)<br>
      
                  # åˆ›å»ºæ–‡æœ¬ç¼–è¾‘æ¡†å¹¶è®¾ç½®å¸ƒå±€<br>
                  txt_edit = tk.Text(wordd, wrap=tk.WORD, width=46, height=25, undo=True)<br>
                  txt_edit.place(x=0, y=0)<br>
      
                  # åˆ›å»ºå‚ç›´æ»šåŠ¨æ¡å¹¶ä¸æ–‡æœ¬ç¼–è¾‘æ¡†å…³è”<br>
                  v_scrollbar = tk.Scrollbar(wordd, orient=tk.VERTICAL, command=txt_edit.yview)<br>
                  v_scrollbar.pack(side=tk.RIGHT, fill=tk.Y)<br>
                  txt_edit.config(yscrollcommand=v_scrollbar.set)<br>
                  txt_edit.delete('1.0', tk.END)<br>
                  # æ’å…¥æ–‡æœ¬å¹¶è®¾ç½®å­—ä½“<br>
                  s = open('ç»¿æ¢µAIä»‹ç».txt', 'r', encoding='utf-8')<br>
                  s = s.read()<br>
      
                  # æ’å…¥æ–‡æœ¬å¹¶è®¾ç½®å­—ä½“<br>
                  txt_edit.insert(tk.END, s, 'custom_font')<br>
                  txt_edit.config(state=tk.DISABLED)<br>
              def think_see():<br>
                  nonlocal æ¨¡å¼_deepseekthink_see<br>
                  if æ¨¡å¼_deepseekthink_see==1:<br>
                      file_menu.entryconfig(1,label='ä¸æ€è€ƒä¸€å¹¶å›ç­” âˆš')<br>
                      æ¨¡å¼_deepseekthink_see=0<br>
                  else:<br>
                      file_menu.entryconfig(1,label='ä¸æ€è€ƒä¸€å¹¶å›ç­”')<br>
                      æ¨¡å¼_deepseekthink_see=1<br>
      
              # åˆ›å»ºèœå•æ <br>
              menu_bar = tk.Menu(green_AIf)<br>
              # æ–‡ä»¶èœå•<br>
              file_menu = tk.Menu(menu_bar, tearoff=0)<br>
              file_menu2 = tk.Menu(menu_bar, tearoff=0)<br>
              file_menu3 = tk.Menu(menu_bar, tearoff=0)<br>
              file_menu4 = tk.Menu(menu_bar, tearoff=0)<br>
              file_menu5 = tk.Menu(menu_bar, tearoff=0)<br>
              file_menu.add_command(label="é‡æ–°å›å¤ ğŸ—˜", command=exchange)<br>
              file_menu.add_command(label="ä¸æ€è€ƒä¸€å¹¶å›ç­”", command=think_see)<br>
      
              file_menu2.add_command(label="ç»¿æ¢µ-R1 âˆš", command=lambda x='DeepSeek-R1': chat(x))<br>
              file_menu2.add_command(label="ç»¿æ¢µ-V3.2", command=lambda x='DeepSeek-V3.2': chat(x))<br>
              file_menu2.add_command(label="ç½‘é¡µæ£€ç´¢-C1", command=lambda x='ç½‘é¡µæ£€ç´¢-C1': chat(x))<br>
      
              file_menu2.add_separator()<br>
              file_menu2.add_command(label="è”ç½‘æ¨¡å¼", command=net)<br>
      
              file_menu2.add_separator()<br>
              file_menu2.add_command(label="æ·±åº¦æ€è€ƒ", command=thought)<br>
      
              file_menu3.add_command(label="344x250", command=mu1)<br>
              file_menu3.add_command(label="644x450", command=mu2)<br>
              file_menu3.add_command(label="744x650", command=mu3)<br>
      
              file_menu4.add_command(label="AIä½œæ–‡", command=AI_text)<br>
              file_menu4.add_command(label="AIç¼–ç¨‹", command=AI_program)<br>
              file_menu4.add_command(label="AIå›¾ç‰‡", command=AI_picture)<br>
              file_menu4.add_command(label="AIç¿»è¯‘", command=AI_ftalk)<br>
      
              file_menu5.add_command(label="ä»‹ç»", command=introduce)<br>
      
              file_menu.entryconfig('é‡æ–°å›å¤ ğŸ—˜', state='disabled')<br>
              menu_bar.add_cascade(label="ç¼–è¾‘", menu=file_menu)<br>
              menu_bar.add_cascade(label="ç‰ˆæœ¬", menu=file_menu2)<br>
              menu_bar.add_cascade(label="çª—å£", menu=file_menu3)<br>
              menu_bar.add_cascade(label="æ›´å¤š", menu=file_menu4)<br>
              menu_bar.add_cascade(label="å…³äº", menu=file_menu5)<br>
              # è®¾ç½®èœå•æ åˆ°çª—å£<br>
              green_AIf.config(menu=menu_bar)<br>
      
              ok_æ¬¡ = 0<br>
              ok_son_exchange = None<br>
      
              def ok_son():<br>
                  nonlocal entry3, ok_æ¬¡<br>
                  global driver, word, word_code, chat_æ§åˆ¶, chat_æ§åˆ¶_control<br>
                  nonlocal æ¨¡å¼_deepseek_æ·±åº¦æ€è€ƒ, æ¨¡å¼_deepseek_è”ç½‘æœç´¢, æ¨¡å¼_deepseekthink_see,chat_net_é¡ºåº,chat_thought_é¡ºåº,æ¨¡å¼_deepseek_ç‰ˆæœ¬, collect_link, btnT_close, ok_son_exchange<br>
                  try:<br>
                      menu_bar.entryconfig('ç‰ˆæœ¬', state='disabled')<br>
                      file_menu.entryconfig(1,state='normal')<br>
                      chat_æ§åˆ¶_control = 1<br>
                      btnT_close = 1<br>
                      if chat_æ§åˆ¶ == 0:<br>
                          txt_edit.tag_config('blue', foreground='#3487FF')<br>
                          word = str(entry3.get())<br>
                          word_code = word  # ä¿å­˜é—®é¢˜åˆ°word_code<br>
                          ok_son_exchange = æ¨¡å¼_deepseek_ç‰ˆæœ¬<br>
                          txt_edit.config(state='normal')<br>
                          DISABLED()<br>
                          txt_edit.insert(tk.END, f'{æ¨¡å¼_deepseek_ç‰ˆæœ¬}\n', 'blue')<br>
                          if æ¨¡å¼_deepseek_æ·±åº¦æ€è€ƒ == 0:<br>
                              if æ¨¡å¼_deepseek_è”ç½‘æœç´¢ == 0:<br>
                                  txt_edit.insert(tk.END, f'æ·±åº¦æ€è€ƒ è”ç½‘æ¨¡å¼\n', 'blue')<br>
                              else:<br>
                                  txt_edit.insert(tk.END, f'æ·±åº¦æ€è€ƒ\n', 'blue')<br>
                          else:<br>
                              if æ¨¡å¼_deepseek_è”ç½‘æœç´¢ == 0:<br>
                                  txt_edit.insert(tk.END, f'è”ç½‘æ¨¡å¼\n', 'blue')<br>
                          txt_edit.insert(tk.END,f'æˆ‘æå‡ºçš„é—®é¢˜:\n{word}\n\n','blue')<br>
                      else:<br>
                          word = word_code  # ä½¿ç”¨ä¿å­˜çš„é—®é¢˜<br>
                          txt_edit.config(state='normal')<br>
                          æ¨¡å¼_deepseek_ç‰ˆæœ¬ = ok_son_exchange<br>
                          DISABLED()<br>
                          txt_edit.insert(tk.END, f'{æ¨¡å¼_deepseek_ç‰ˆæœ¬}\n', 'blue')<br>
                          if æ¨¡å¼_deepseek_æ·±åº¦æ€è€ƒ == 0:<br>
                              if æ¨¡å¼_deepseek_è”ç½‘æœç´¢ == 0:<br>
                                  txt_edit.insert(tk.END, f'æ·±åº¦æ€è€ƒ è”ç½‘æ¨¡å¼\n', 'blue')<br>
                              else:<br>
                                  txt_edit.insert(tk.END, f'æ·±åº¦æ€è€ƒ\n', 'blue')<br>
                          else:<br>
                              if æ¨¡å¼_deepseek_è”ç½‘æœç´¢ == 0:<br>
                                  txt_edit.insert(tk.END, f'è”ç½‘æ¨¡å¼\n', 'blue')<br>
                          txt_edit.insert(tk.END, f'é‡æ–°å›ç­”:\n{word}\n\n', 'blue')<br>
      
                      # è§£ç»‘æŒ‡å®šäº‹ä»¶<br>
                      green_AIf.unbind('<Return>')<br>
                      txt_edit.config(state='normal')<br>
                      DISABLED()<br>
                      entry3.delete(0, tk.END)<br>
                      # ä½¿ç”¨afterèƒ½è§£å†³æ— å“åº”é—®é¢˜<br>
                      # åˆ·æ–°<br>
                      green_AIf.update()<br>
                      # ğŸ‘‡ å…³é”®ï¼šå¯¹ word è¿›è¡Œ URL ç¼–ç ï¼ˆå†™ç½‘å€çš„æ—¶å€™å¯ç”¨ï¼‰<br>
                      # from urllib.parse import quote<br>
                      # word = quote(word, safe='')<br>
                      url = f'https://chat.baidu.com/search?&dyTabStr=MCwxMiwzLDEsMiwxMyw3LDYsNSw5&pd=csaitab&setype=csaitab&extParamsJson=%7B%22enter_type%22%3A%22search_a_tab%22%2C%22sa%22%3A%22vs_tab%22%2C%22apagelid%22%3A%229405376116451188355%22%2C%22ori_lid%22%3A%229405376116451188355%22%7D'<br>
                      # æ’å…¥æ–‡æœ¬å†…å®¹<br>
                      driver.get(url)  # æ‰“å¼€ç½‘é¡µ<br>
                      chat(æ¨¡å¼_deepseek_ç‰ˆæœ¬)<br>
      
                      if (æ¨¡å¼_deepseek_è”ç½‘æœç´¢ == 0):<br>
                          chat_net_é¡ºåº-=1<br>
                          net()<br>
                      if (æ¨¡å¼_deepseek_æ·±åº¦æ€è€ƒ == 0):<br>
                          chat_thought_é¡ºåº-=1<br>
                          thought()<br>
                      DISABLED()<br>
                      menu_bar.entryconfig('ç‰ˆæœ¬', state='disabled')<br>
                      # æ‰‹åŠ¨æ¨¡å¼ï¼šå¯¹AIçˆ¬å–è¾“å…¥ä¿¡æ¯çš„å¦ä¸€ä¸­æ–¹å¼ï¼ˆè¾ƒå¤æ‚ï¼‰<br>
                      # å®šä½è¾“å…¥æ¡†å…ƒç´ ï¼ˆæ”¯æŒå¤šç§å®šä½æ–¹å¼ï¼‰<br>
                      input_element = driver.find_element(By.ID, "chat-textarea")<br>
                      input_element.send_keys('è¯·ä»…ä»¥çº¯æ–‡æœ¬å½¢å¼å›å¤ï¼Œä¸è¦ä½¿ç”¨ä»»ä½•æ ¼å¼åŒ–è¯­æ³•ï¼Œæ¯æ®µè‡³å°‘æœ‰ä¸€è¡Œçº¯æ–‡æœ¬å›ç­”ã€‚' + str(word))<br>
      
                      # æ¨¡æ‹Ÿå›è½¦é”®æäº¤<br>
                      input_element.send_keys(Keys.RETURN)  # åˆ·æ–°è®©å…¶æ˜¾ç¤º<br>
                      green_AIf.update()<br>
                      try:<br>
                          txt_edit.insert(tk.END, f'æ€è€ƒä¸­~\n')<br>
                          DISABLED()<br>
                          green_AIf.update()<br>
                          # ç­‰å¾…ç¬¬ä¸€ä¸ªAIæ®µè½å‡ºç°<br>
                          try:<br>
                              WebDriverWait(driver, 25, 0.3).until(<br>
                                  # ä½¿ç”¨ç¨³å®šçš„é€‰æ‹©å™¨<br>
                                  # class=è¿™ç§æœ€ç²¾ç¡®ï¼Œä¸æ˜¯åªè¦åŒ…å«è¿™ä¸ªå…ƒç´ åå°±è¡Œ<br>
                                  EC.presence_of_element_located((By.CSS_SELECTOR, "[class*='marklang-paragraph']"))<br>
                              )<br>
                          except:<br>
                              if (chat_æ§åˆ¶ != 0):<br>
                                  txt_edit.insert(tk.END, f'çª—å£è«åå‡ºç°äº†é—®é¢˜ï¼Œè¯·é‡æ–°è¿›å…¥~\n', 'error')<br>
                                  return<br>
                              else:<br>
                                  txt_edit.insert(tk.END, f'çª—å£è«åå‡ºç°äº†é—®é¢˜ï¼Œæ­£åœ¨é‡è¯•~\n', 'error')<br>
                                  green_AIf.update()<br>
                                  # é‡æ–°æ‰§è¡Œé‡æ–°å›ç­”é€»è¾‘<br>
                                  chat_æ§åˆ¶ = 1<br>
                                  ok()<br>
                                  return<br>
                          # txt_edit.insert(tk.END, f'æ­£åœ¨ç»„ç»‡å›ç­”~\n')<br>
                          green_AIf.update()<br>
                          # ç­‰å¾…è‡³å°‘2ä¸ªæ®µè½å‡ºç°ï¼ˆç¡®ä¿å…¶å†…å®¹å®Œæ•´ï¼Œé¿å…é—æ¼ï¼‰ä½¿ç”¨æœ€å¼ºå¤§çš„pythoné€‰æ‹©å™¨<br>
                          WebDriverWait(driver, 180, 0.3).until(<br>
                              lambda d: len(d.find_elements(By.CSS_SELECTOR, "[class*='marklang']")) >= 1<br>
                          )<br>
                          DISABLED()<br>
                      except Exception as e:<br>
                          txt_edit.insert(tk.END, f'é”™è¯¯,è¯·é‡è¯•~\n{e}\n', 'error')<br>
                          green_AIf.update()<br>
                          return<br>
      
                      # æ£€æŸ¥æ˜¯å¦å…¨éƒ¨ç”Ÿæˆå‡ºæ¥<br>
                      try:<br>
                          WebDriverWait(driver, 180, 0.3).until(<br>
                              # untilåªèƒ½æœ‰ä¸€ä¸ªç­‰å¾…å€¼ä½†æ˜¯any_of/all_ofå¯ä»¥æœ‰å¤šä¸ª<br>
                              EC.all_of(<br>
                                  # ä½¿ç”¨ç¨³å®šçš„é€‰æ‹©å™¨<br>
                                  # class=è¿™ç§æœ€ç²¾ç¡®ï¼Œä¸æ˜¯åªè¦åŒ…å«è¿™ä¸ªå…ƒç´ åå°±è¡Œ<br>
                                  # class*=è¿™ç§åªè¦éƒ¨åˆ†è¾¾æ ‡å³å¯å¯ä»¥é˜²æ­¢å› ç½‘é¡µä»£ç æ›´æ–°é€ æˆçš„é”™è¯¯<br>
                                  EC.presence_of_element_located((By.CSS_SELECTOR, "[class*='cos-icon cos-icon-exchange']")),<br>
                              )<br>
                          )<br>
                      except Exception as e:<br>
                          txt_edit.insert(tk.END, f'ç³»ç»Ÿè¶…æ—¶~\n{e}\n', 'error')<br>
                          green_AIf.update()<br>
                      txt_edit.insert(tk.END, f'å³å°†ç”Ÿæˆå›å¤~\n\n')<br>
                      green_AIf.update()<br>
                      DISABLED()<br>
      
                      green_AIf.after(1500)  # ç»™ JavaScript ç•™å‡ºæ—¶é—´å®Œæˆæ¸²æŸ“<br>
                      # æ»šåŠ¨åˆ°åº•éƒ¨ï¼Œè§¦å‘æ‰€æœ‰å†…å®¹æ¸²æŸ“<br>
                      driver.execute_script("window.scrollTo(0, document.body.scrollHeight);")<br>
                      green_AIf.after(1500)<br>
                      # ä½¿ç”¨ Selenium ç›´æ¥æŸ¥æ‰¾æ‰€æœ‰ AI æ®µè½<br>
                      if æ¨¡å¼_deepseekthink_see!=0:<br>
                          #å…³é—­æ·±åº¦æ€è€ƒæ‰“å°éƒ¨åˆ†<br>
                          parent_elements = driver.find_elements(By.CSS_SELECTOR, "[class*='ai-entry-block adjust-layout ai-markdown']")<br>
                          #divä¸­æå–ä¸ºåˆ—è¡¨å½¢å¼<br>
                          paragraphs = []<br>
                          # éå†æ¯ä¸ªçˆ¶å…ƒç´ ï¼Œä»ä¸­æŸ¥æ‰¾æ®µè½<br>
                          for parent in parent_elements:<br>
                              try:<br>
                                  child_paragraphs = parent.find_elements(By.CSS_SELECTOR, "[class*='marklang-paragraph']")<br>
                                  paragraphs.extend(child_paragraphs)#å°†æ‰€æœ‰å…ƒç´ ç»„åˆåˆ°ä¸€èµ·<br>
                              except:<br>
                                  continue<br>
                      else:<br>
                          paragraphs = driver.find_elements(By.CSS_SELECTOR, "[class*='marklang-paragraph']")<br>
                      # éå†å¹¶è¾“å‡ºæ¯ä¸€æ®µå†…å®¹<br>
                      for i, p in enumerate(paragraphs, 0):<br>
                          try:<br>
                              # å®æ—¶æ‰¾æœ€æ–°çš„å…ƒç´ <br>
                              # p = driver.find_elements(By.CSS_SELECTOR, "[class*='marklang-paragraph']")[i]  #é‡å¤æŸ¥æ‰¾å¯èƒ½å¯¼è‡´å…ƒç´ ä¸¢å¤±<br>
                              text = p.text.strip()  # å»é™¤é¦–å°¾ç©ºç™½å­—ç¬¦<br>
                              if text:  # é¿å…è¾“å‡ºç©ºæ®µè½<br>
                                  txt_edit.config(font=('å¾®è½¯é›…é»‘', 11, 'bold'))<br>
                                  txt_edit.insert(tk.END, f'{text}\n\n')<br>
                                  txt_edit.config(font=('å¾®è½¯é›…é»‘', 11))<br>
                                  green_AIf.update()<br>
                          except Exception as e:<br>
                              txt_edit.insert(tk.END, f'å‘ç”Ÿé”™è¯¯:{e}\n', 'error')<br>
                              green_AIf.update()<br>
                          else:<br>
                              file_menu.entryconfig('é‡æ–°å›å¤ ğŸ—˜', state='normal')<br>
                      DISABLED()<br>
                      try:<br>
                          # æœ‰å¤šå¼ class=xçš„å›¾ç‰‡<br>
                          images = driver.find_elements(By.CSS_SELECTOR, "[class*='_chat-guide-tooltip']")<br>
                          # éå†å¹¶è¾“å‡ºæ¯ä¸€å¼ å›¾ç‰‡<br>
                          for j, image in enumerate(images, 0):<br>
                              # æœ‰å¤šå¼ class=xçš„å›¾ç‰‡<br>
                              image = image.find_elements(By.CSS_SELECTOR, "img[class*='_image-visible']")<br>
                              # é˜²æ­¢å…ƒç´ è¿‡æœŸ<br>
                              for z, img in enumerate(image, 0):<br>
                                  # attributeå±æ€§<br>
                                  img_src = img.get_attribute("src")<br>
                                  if img_src and not img_src.startswith("data:"):  # è¿‡æ»¤ base64 å ä½å›¾<br>
                                      try:<br>
                                          response = requests.get(img_src, timeout=10)<br>
                                          img_data = BytesIO(response.content)  # å°†å†…å®¹è½½å…¥å†…å­˜æµ<br>
                                          img = Image.open(img_data)<br>
                                          # è°ƒæ•´å›¾ç‰‡å¤§å°ï¼ˆå¯é€‰ï¼Œé¿å…è¿‡å¤§ï¼‰<br>
                                          img.thumbnail((270, 270))  # æœ€å¤§å®½é«˜ 270px<br>
                                          img_tk = ImageTk.PhotoImage(img)<br>
                                          # åœ¨ Tkinter æ–‡æœ¬æ¡†ä¸­æ˜¾ç¤ºå›¾ç‰‡<br>
                                          collect_link += 1<br>
                                          txt_edit.tag_config(f'{collect_link}', foreground='#2DC9B4', underline=True)<br>
                                          txt_edit.insert(tk.END, f"\nå›¾ç‰‡:\n{img_src}\n\n", f'{collect_link}')<br>
                                          txt_edit.tag_bind(f"{collect_link}", "<Button-1>",lambda e: open_link(f"{img_src}"))<br>
      
                                          txt_edit.image_create(tk.END, image=img_tk)<br>
                                          txt_edit.insert(tk.END, "\n\n")<br>
                                          # ä¿®æ­£ï¼šä½¿ç”¨åˆ—è¡¨ä¿å­˜æ‰€æœ‰å›¾ç‰‡å¼•ç”¨ï¼Œè€Œä¸æ˜¯è¦†ç›–å•ä¸ªå˜é‡<br>
                                          if not hasattr(txt_edit, 'image_list'):<br>
                                              txt_edit.image_list = []<br>
                                          txt_edit.image_list.append(img_tk)  # ä¿å­˜å¼•ç”¨åˆ°åˆ—è¡¨ï¼Œé˜²æ­¢åƒåœ¾å›æ”¶<br>
                                      except:<br>
                                          ERROR = response.raise_for_status()  # æŠ›å‡º HTTP é”™è¯¯ï¼ˆå¦‚ 404ã€500ï¼‰<br>
                                          txt_edit.insert(tk.END, f'å‘ç”Ÿé”™è¯¯:{ERROR}', 'error')<br>
                      except:<br>
                          # print('æ— å›¾ç‰‡')<br>
                          green_AIf.update()<br>
                  except Exception as e:<br>
                      txt_edit.insert(tk.END, f'å‘ç”Ÿé”™è¯¯:{e}\n', 'error')<br>
                      # print(f"å‘ç”Ÿé”™è¯¯: {e}")<br>
                      green_AIf.update()<br>
                  finally:<br>
                      # é‡Šæ”¾å†…å­˜å’Œç³»ç»Ÿèµ„æº<br>
                      chat_æ§åˆ¶ = 0<br>
                      chat_æ§åˆ¶_control = 0<br>
                      btnT_close = 0<br>
                      collect_exchange = 0<br>
                      menu_bar.entryconfig('ç‰ˆæœ¬', state='normal')<br>
                      #txt_edit.insert(tk.END, f'å›ç­”å·²ç»“æŸ~\n\n\n')<br>
                      txt_edit.insert(tk.END,'--------------------------\n\n','blue')<br>
                      green_AIf.bind('<Return>', lambda event: ok())<br>
                      NORMAL()<br>
                      file_menu.entryconfig('é‡æ–°å›å¤ ğŸ—˜', state='normal')<br>
                      txt_edit.config(state='disabled')<br>
                      green_AIf.update()<br>
      
              def close():<br>
                  try:<br>
                      driver.quit()<br>
                      green_AIf.destroy()<br>
                  except:<br>
                      pass<br>
      
              def ok():<br>
                  global chat_æ§åˆ¶, chat_æ§åˆ¶_control<br>
                  nonlocal collect_continue, btnT_close<br>
                  if btnT_close == 1:<br>
                      return<br>
                  #print('chat_æ§åˆ¶(ok):' + str(chat_æ§åˆ¶))<br>
                  try:<br>
                      if entry3.get() == '' and collect_exchange == 0:<br>
                          return<br>
                      menu_bar.entryconfig('ç‰ˆæœ¬', state='disabled')<br>
                      if chat_æ§åˆ¶ == 2:<br>
                          threading.Thread(target=collect, daemon=True).start()<br>
                      else:<br>
                          collect_continue = 0<br>
                          threading.Thread(target=ok_son, daemon=True).start()<br>
                  finally:<br>
                      return<br>
      
              # ç»‘å®šçª—å£å…³é—­äº‹ä»¶åˆ°è‡ªå®šä¹‰å‡½æ•°<br>
              green_AIf.protocol("WM_DELETE_WINDOW", close)<br>
      
              try:<br>
                  full_image_path = 'å‘é€-ç»¿æ¢µAI-9.png'<br>
                  # ä½¿ç”¨PillowåŠ è½½å›¾ç‰‡å¹¶è°ƒæ•´å¤§å°ï¼ˆå¦‚æœéœ€è¦ï¼‰<br>
                  original_image = Image.open(full_image_path)<br>
                  resized_image = original_image.resize((38, 37), Image.Resampling.LANCZOS)  # è°ƒæ•´å¤§å°<br>
      
                  # å°†PILå›¾åƒè½¬æ¢ä¸ºTkinterå…¼å®¹çš„å›¾åƒ<br>
                  img = ImageTk.PhotoImage(resized_image)<br>
      
                  btnT = ttk.Button(green_AIf, style='TButton', image=img, text='''å‘é€''', command=ok)<br>
                  btnT.place(x=275, y=175, height=48, width=48)<br>
              except:<br>
      
                  txt_edit.insert(tk.END, 'æŒ‰é’®åˆå§‹åŒ–å¼‚å¸¸~', 'error')<br>
              # ç”¨äºå­˜å‚¨å›¾ç‰‡å¼•ç”¨ï¼Œé˜²æ­¢è¢«åˆ é™¤<br>
              stored_images = {}<br>
              def IMAGE(full_image_path):<br>
                  nonlocal btnT<br>
                  # ä½¿ç”¨PillowåŠ è½½å›¾ç‰‡å¹¶è°ƒæ•´å¤§å°ï¼ˆå¦‚æœéœ€è¦ï¼‰<br>
                  original_image = Image.open(full_image_path)<br>
                  resized_image = original_image.resize((btnT_image_height, btnT_image_width),Image.Resampling.LANCZOS)  # è°ƒæ•´å¤§å°<br>
                  # å°†PILå›¾åƒè½¬æ¢ä¸ºTkinterå…¼å®¹çš„å›¾åƒ<br>
                  img = ImageTk.PhotoImage(resized_image)<br>
                  btnT.destroy()<br>
                  btnT = ttk.Button(green_AIf, style='TButton', image=img, command=ok)<br>
                  btnT.place(x=btnT_x, y=btnT_y, height=btnT_height, width=btnT_width)<br>
                  return img<br>
              def NORMAL():<br>
                  nonlocal btnT, btnT_x, btnT_y, btnT_height, btnT_width, btnT_image_height, btnT_image_width, btnT_close<br>
                  try:<br>
                      btnT_close = 0<br>
                      # ï¼ï¼ï¼å…³é”®ï¼šä¿å­˜å›¾ç‰‡å¼•ç”¨ï¼Œé˜²æ­¢è¢«åˆ é™¤ï¼ï¼ï¼<br>
                      stored_images['normal_btn']=IMAGE('å‘é€-ç»¿æ¢µAI-9.png')<br>
                  except:<br>
                      txt_edit.insert(tk.END, 'æŒ‰é’®åˆå§‹åŒ–å¼‚å¸¸~', 'error')<br>
                  finally:<br>
                      btnT_close = 0<br>
              btnT_close = 0<br>
              def DISABLED():<br>
                  nonlocal btnT, btnT_x, btnT_y, btnT_height, btnT_width, btnT_image_height, btnT_image_width, btnT_close<br>
                  try:<br>
                      btnT_close = 1<br>
                      # ï¼ï¼ï¼å…³é”®ï¼šä¿å­˜å›¾ç‰‡å¼•ç”¨ï¼Œé˜²æ­¢è¢«åˆ é™¤ï¼ï¼ï¼<br>
                      stored_images['disabled_btn'] =IMAGE('ç”Ÿæˆ-ç»¿æ¢µAI-3.png')<br>
                      btnT.configure(state='disabled')<br>
                  except:<br>
                      txt_edit.insert(tk.END, 'æŒ‰é’®åˆå§‹åŒ–å¼‚å¸¸~\n', 'error')<br>
                  finally:<br>
                      btnT_close = 1<br>
      
              green_AIf.bind('<Return>', lambda event: ok())<br>
              mu1()<br>
              green_AIf.mainloop()<br>
         except Exception as e:<br>
              txt_edit.insert(tk.END, f'å‘ç”Ÿé”™è¯¯:{e}', 'error')<br>
      
      def destroy_window():<br>
          green_f.destroy()<br>
          main()<br>
      
      driver = ''<br>
      nex_son_close=0<br>
      
      def nex_son():<br>
          global place, ç‰ˆæœ¬, é¡ºåº, driver,nex_son_close<br>
          if é¡ºåº == 0:<br>
              place = entry1.get()<br>
              # æ·»åŠ æµè§ˆå™¨å¯åŠ¨å‚æ•°(å‘½ä»¤å‚æ•°)<br>
              place = 'C:\Program Files\Google\Chrome Dev\Application\chrome.exe'<br>
              if place=='':<br>
                  return<br>
              entry1.delete(0, 'end')<br>
              Label2.config(text='è¾“å…¥Google Chromeçš„ç‰ˆæœ¬å·')<br>
              btn1.configure(text='å®Œæˆ')<br>
              é¡ºåº += 1<br>
              return<br>
          else:<br>
              ç‰ˆæœ¬ = entry1.get()<br>
              # éœ€å®šæœŸæ›´æ¢<br>
              ç‰ˆæœ¬ = '146.0.7655.3'<br>
              if ç‰ˆæœ¬=='':<br>
                  return<br>
              nex_son_close=1<br>
              btn1.config(state='disabled')<br>
              # é…ç½®Chromeæµè§ˆå™¨é€‰é¡¹<br>
              try:<br>
      
                  options = webdriver.ChromeOptions()<br>
                  options.binary_location = rf'{place}'<br>
      
                  # options.add_argument('--headless')  # éƒ¨åˆ†ç¯å¢ƒå¯¹æ–°ç‰ˆæ— å¤´æ¨¡å¼å…¼å®¹æ€§ä¸ä½³<br>
                  options.add_argument('--disable-dev-shm-usage')  # è§£å†³å®¹å™¨ç¯å¢ƒå†…å­˜é—®é¢˜<br>
                  options.add_argument('--headless=new')  # å¯ç”¨æ–°ç‰ˆæ— å¤´æ¨¡å¼ï¼ˆåå°è¿è¡Œï¼Œä¸æ˜¾ç¤ºçª—å£ï¼‰<br>
                  options.add_argument('--no-sandbox')  # ç¦ç”¨æ²™ç›’ï¼ˆæé«˜å…¼å®¹æ€§ï¼‰<br>
                  options.add_argument('--disable-gpu')  # ç¦ç”¨ GPU åŠ é€Ÿï¼ˆé¿å…æŸäº›ç¯å¢ƒå´©æºƒï¼‰<br>
                  options.add_argument('--window-size=1920,1080')  # è®¾ç½®çª—å£å¤§å°<br>
                  options.add_experimental_option("excludeSwitches", ["enable-automation"])  # éšè—"è‡ªåŠ¨åŒ–æ§åˆ¶"æç¤º<br>
                  options.add_argument('--disable-blink-features=AutomationControlled')  # é˜²æ­¢ç½‘ç«™æ£€æµ‹è‡ªåŠ¨åŒ–<br>
                  options.add_argument('disk-cache-size=1')  # ç¼“å­˜é™åˆ¶1MB<br>
                  # åˆå§‹åŒ–æµè§ˆå™¨é©±åŠ¨<br>
                  service = Service(ChromeDriverManager(ç‰ˆæœ¬).install())<br>
                  # service: é©±åŠ¨æœåŠ¡ï¼›options: æµè§ˆå™¨é…ç½®<br>
                  # æ­¤æ—¶ä¼šå¯åŠ¨ä¸€ä¸ª Chrome æµè§ˆå™¨ï¼ˆæ— å¤´æ¨¡å¼ä¸‹ä¸å¯è§ï¼‰<br>
                  # è¿™ä¸ªå°±æ˜¯å°†æµè§ˆå™¨çš„é©±åŠ¨å’Œé…ç½®å‘Šè¯‰driverè¿™ä¸ªå‡è£…ç”¨æˆ·çš„ä¸œè¥¿è®©ä»–ä»£æ›¿ä»–ä»¬å»æ‰§è¡Œå¯¹æµè§ˆå™¨çš„æ“ä½œ<br>
                  driver = webdriver.Chrome(service=service, options=options)<br>
                  entry1.place_forget()<br>
                  btn1.place_forget()<br>
                  Label2.place_forget()<br>
                  Label1.config(text='å®Œæˆè®¾ç½®,æ­£å‡†å¤‡å¯åŠ¨...')<br>
                  url = 'https://chat.baidu.com/search?&dyTabStr=MCwxMiwzLDEsMiwxMyw3LDYsNSw5&pd=csaitab&setype=csaitab&extParamsJson=%7B%22enter_type%22%3A%22search_a_tab%22%2C%22sa%22%3A%22vs_tab%22%2C%22apagelid%22%3A%229405376116451188355%22%2C%22ori_lid%22%3A%229405376116451188355%22%7D'<br>
                  driver.get(url)<br>
                  green_f.after(1000, destroy_window)<br>
              except Exception as e:<br>
                  entry1.place_forget()<br>
                  btn1.place_forget()<br>
                  Label2.place_forget()<br>
                  Label1.config(text=f'å‘ç”Ÿé”™è¯¯ï¼Œè¯·é‡è¯•...', font=('å¾®è½¯é›…é»‘ Light', 17))<br>
                  btn11 = ''<br>
                  wrong_answer = f'{e}'<br>
      
                  def wrong():<br>
                      nonlocal btn11, wrong_answer<br>
                      # å¤šè¡Œæ–‡æœ¬æ¡†åŒºåŸŸ<br>
                      text_frame = tk.LabelFrame(green_f, text='è¯¦ç»†ä¿¡æ¯:', font=('å¾®è½¯é›…é»‘', 11))<br>
                      text_frame.place(x=17, y=75)<br>
                      text_box = ScrolledText(text_frame, state=tk.NORMAL, wrap=tk.WORD, font=("å¾®è½¯é›…é»‘", 11), borderwidth=1,relief="groove", height=6, width=32)<br>
                      text_box.pack(fill=tk.BOTH, padx=5, pady=5)<br>
                      text_box.insert('1.0', f'{wrong_answer}')<br>
                      text_box.config(state=tk.DISABLED)<br>
                      btn.place_forget()<br>
                      def up():<br>
                          nonlocal btn11, wrong_answer<br>
                          text_frame.destroy()<br>
                          text_box.destroy()<br>
                          btn11.destroy()<br>
                          btn.place(x=250, y=28)<br>
      
                      btn11 = tk.Button(green_f, text="æ”¶èµ·ä¿¡æ¯", font=("å¾®è½¯é›…é»‘ Light", 13, 'bold'), borderwidth=0,fg="#FFB348", command=up)<br>
                      btn11.place(x=250, y=28)<br>
                  btn = tk.Button(green_f, text="è¯¦ç»†ä¿¡æ¯", font=("å¾®è½¯é›…é»‘ Light", 13, 'bold'), borderwidth=0, fg="#FFB348",command=wrong)<br>
                  btn.place(x=250, y=28)<br>
      
      def nex():<br>
          global nex_son_close<br>
          if nex_son_close==1:<br>
              return<br>
          threading.Thread(target=nex_son, daemon=True).start()<br>
      btn1 = ttk.Button(green_f, style='TButton', text='ä¸‹ä¸€æ­¥', command=nex)<br>
      btn1.place(x=250, y=155, height=34, width=86)<br>
      green_f.bind('<Return>', lambda event: nex())<br>
      green_f.mainloop()<br>
          
    </p>

    
  </body>
</html>
